<?xml version="1.0" encoding= "UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ben.simpleshiro.logic.mapper.LoginMapper">

    <select id="getUserByName" resultType="com.ben.simpleshiro.logic.bo.User">
        select *
        from s_sys_user
        where username = #{username}
    </select>

    <select id="getUserRole" resultType="com.ben.simpleshiro.logic.bo.Role">
        select a.id, org_id, role_name, a.role_code, role_type, data_scope, status
        from s_sys_role a
                 left join s_sys_user_role b on a.id = b.role_id and b.user_id = #{id}
        where a.delete_flag = 0
    </select>

    <select id="getUserPermissions" resultType="com.ben.simpleshiro.logic.bo.Permission">
        select a.id, parent, name, permission, sort, href, target, icon, is_show, comment, status
        from s_sys_permission a
        left join s_sys_role_permission b on a.id=b.permission_id
        where a.delete_flag=0 and b.role_id in
        <foreach collection="list" item="role" separator="," open="(" close=")">
            #{role.id}
        </foreach>
    </select>


</mapper>